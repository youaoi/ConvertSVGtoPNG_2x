# ConvertSVGtoPNG_2x / SVG to High-Quality PNG Converter (VBScript)

ドラッグ＆ドロップするだけで、SVGファイルを**高品質なPNGファイル**に変換できるWindows用VBScriptです。拡大率やピクセルサイズを柔軟に指定できます。

## ✨ 特徴 (Features)

* **簡単な操作**: 変換したいSVGファイルをスクリプトアイコンにドラッグ＆ドロップするだけです。
* **柔軟なサイズ指定**: ダイアログで、倍率・パーセント・幅/高さ（ピクセル）など、多彩な形式で出力サイズを指定できます。
* **高品質な変換**: どのようなサイズ指定でも、ImageMagickの機能を最大限に活用し、SVGのシャープさを損なわずにクリアなPNGを生成します。
* **複数ファイル対応**: 複数のSVGファイルを一度にまとめて処理できます。
* **背景透過**: 生成されるPNGの背景は自動的に透過になります。

## ⚙️ 動作要件 (Requirements)

* **OS**: Windows
* **依存ソフトウェア**: **[ImageMagick](https://imagemagick.org/)**
    * このスクリプトは内部でImageMagickのコマンドを呼び出しています。**必ず事前にインストールしてください。**

## 🚀 セットアップ (Setup)

### 1. ImageMagickのインストール

1.  [**ImageMagickの公式サイト**](https://imagemagick.org/script/download.php)にアクセスし、Windows用のインストーラーをダウンロードします。
2.  インストーラーを起動し、ウィザードに従ってインストールを進めます。
3.  **インストールの途中で表示される以下のオプションに、必ずチェックを入れてください。**
    * `Add application directory to your system path (PATH)`
    * `Install legacy utilities (e.g., convert)`

### 2. VBScriptファイルのダウンロード

1.  このリポジトリから `ConvertSVGtoPNG_2x.vbs` ファイルをダウンロードします。
2.  ダウンロードしたファイルを、デスクトップなどの使いやすい場所に配置してください。

> [!IMPORTANT]
> **⚠️ 文字コードに関する重要なお知らせ**
>
> GitHubからファイルをダウンロードすると、文字コードが `UTF-8` で保存されます。スクリプト内の日本語メッセージが原因でエラーが発生する可能性があるため、以下の手順で文字コードを変更してください。
>
> 1.  ダウンロードした `ConvertSVGtoPNG_2x.vbs` を右クリックし、「編集」を選択してメモ帳で開きます。
> 2.  「ファイル」メニューから「名前を付けて保存」を選びます。
> 3.  ダイアログの下部にある **文字コード（エンコード）** のプルダウンメニューから **`ANSI`** を選択し、保存します。（`ANSI` は `Shift_JIS` に相当します）

## 使い方 (Usage)

1.  変換したいSVGファイル（複数可）を選択します。
2.  選択したファイルを、`ConvertSVGtoPNG_2x.vbs` のアイコン上に**ドラッグ＆ドロップ**します。
3.  **サイズ指定のダイアログ**が表示されるので、希望のサイズを入力して「OK」をクリックします。
4.  処理が完了するとメッセージが表示され、元のSVGファイルと同じフォルダにPNGファイルが作成されます。

### サイズ指定の形式

ダイアログでは、以下の形式でサイズを指定できます。

| 入力例        | 説明                                                     |
| :------------ | :------------------------------------------------------- |
| `x2` or `x1.5`  | **倍率**で指定します (例: 2倍, 1.5倍)                    |
| `200` or `150`  | **パーセント**で指定します (例: 200%, 150%)              |
| `w500`          | **幅**をピクセルで指定します (例: 幅500px)。高さは自動調整されます。 |
| `h300`          | **高さ**をピクセルで指定します (例: 高さ300px)。幅は自動調整されます。 |
| `400x250`       | **幅と高さを厳密に指定**します。アスペクト比は無視されます。 |

## 🛠️ 仕組み (How it Works)

このスクリプトは、入力されたサイズ指定に応じて最適なImageMagickコマンドを生成し、高品質な変換を実現しています。

* **倍率/パーセント指定の場合 (`x2`, `150`など)**
    SVGをラスタライズ（ビットマップ化）する際の解像度 (`-density`) を入力値から動的に計算します。これにより、SVGのベクター情報を最大限に活かした、ディテールの細かいPNGを生成します。
    ```bash
    # x2 と入力した場合
    magick convert -density 192 ... "input.svg" "output.png"
    ```

* **ピクセル指定の場合 (`w500`, `h300`など)**
    まず `-density 600` オプションでSVGを意図的に非常に大きな解像度でメモリ上に描画します。その後、`-resize` オプションでその高精細な画像をターゲットのピクセルサイズに縮小します。小さな画像を拡大するのとは逆に、大きな画像を縮小することで、画質の劣化を防ぎ、シャープな結果を得ています。
    ```bash
    # w500 と入力した場合
    magick convert -density 600 -resize 500x ... "input.svg" "output.png"
    ```

## 📄 ライセンス (License)

このプロジェクトは [MIT License](LICENSE) の下で公開されています。
